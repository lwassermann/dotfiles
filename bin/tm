#!/bin/sh
#
# Start a new tmux session in a specific directory
#
# Sets the tmux working directory and configures a session name
# based on the given target directory path.
#
# If a session with the derived name already exists,
# attaches to it instead of starting a new one.
#
# Usage:
#
#   tm ~/.dotfiles
#   tm projects/x

directory=$(realpath ${1:-.})

if ! test -d $directory; then
  echo "Usage: tm [directory]" 1>&2
  exit 1
fi

basename=$(basename ${directory})
name=$(echo ${basename#.} | tr "." "-")

exec tmux new-session -A -c $directory -s $name
